{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport React, { Component } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { db, auth } from \"../firebase/config\";\nimport firebase from 'firebase';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport UnComentario from \"../Components/UnComentario\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar Comments = function (_Component) {\n  _inherits(Comments, _Component);\n  var _super = _createSuper(Comments);\n  function Comments(props) {\n    var _this;\n    _classCallCheck(this, Comments);\n    _this = _super.call(this, props);\n    _this.state = {\n      comments: '',\n      id: _this.props.route.params.idPost,\n      post: [],\n      loading1: true,\n      username: '',\n      fotoUsuario: '',\n      bioUsuario: ''\n    };\n    return _this;\n  }\n  _createClass(Comments, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      db.collection('posts').doc(this.state.id).onSnapshot(function (doc) {\n        _this2.setState({\n          post: doc.data(),\n          loading1: false\n        }, function () {\n          return _this2.setState({\n            commentsOrder: _this2.state.post.comments.reverse()\n          });\n        });\n      });\n      db.collection('users').where('owner', '==', this.props.route.params.mail).onSnapshot(function (docs) {\n        var usuario = [];\n        docs.forEach(function (doc) {\n          usuario.push({\n            id: doc.id,\n            data: doc.data()\n          });\n          _this2.setState({\n            username: usuario[0].data.username,\n            fotoUsuario: usuario[0].data.foto,\n            bioUsuario: usuario[0].data.bio\n          });\n        });\n      });\n    }\n  }, {\n    key: \"sendComment\",\n    value: function sendComment(comments) {\n      var _this3 = this;\n      db.collection('posts').doc(this.state.id).update({\n        comments: firebase.firestore.FieldValue.arrayUnion({\n          owner: auth.currentUser.email,\n          comments: comments,\n          createdAt: Date.now()\n        })\n      }).then(function () {\n        _this3.setState({\n          comments: ''\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n      return _jsx(View, {\n        style: styles.scroll,\n        children: this.state.loading1 === true ? _jsx(ActivityIndicator, {\n          size: \"large\",\n          color: \"green\"\n        }) : _jsxs(View, {\n          style: styles.scroll,\n          children: [_jsxs(View, {\n            style: styles.containerPost,\n            children: [_jsx(Image, {\n              style: styles.profilePhoto,\n              source: {\n                uri: this.state.fotoUsuario\n              },\n              resizeMode: \"auto\"\n            }), _jsx(Text, {\n              style: styles.username,\n              children: this.state.username\n            }), _jsx(Image, {\n              style: styles.postPhoto,\n              source: {\n                uri: this.state.post.photo\n              },\n              resizeMode: \"contain\"\n            }), \"View\", _jsx(Text, {\n              style: styles.bio,\n              children: this.state.post.text\n            })]\n          }), _jsxs(View, {\n            style: styles.containerAdd,\n            children: [_jsx(TextInput, {\n              style: styles.input,\n              placeholder: \"Agregar Comentario\",\n              keyboardType: \"default\",\n              onChangeText: function onChangeText(text) {\n                return _this4.setState({\n                  comments: text\n                });\n              },\n              value: this.state.comments\n            }), _jsx(TouchableOpacity, {\n              style: styles.sendCont,\n              onPress: function onPress() {\n                return _this4.sendComment(_this4.state.comments);\n              },\n              children: _jsx(Image, {\n                style: styles.send,\n                source: require(\"../../assets/send.svg\"),\n                resizeMode: \"contain\"\n              })\n            })]\n          }), this.state.post.comments.length === 0 && this.state.loading1 === false ? _jsx(Text, {\n            children: \"no hay comentarios\"\n          }) : _jsx(FlatList, {\n            style: styles.containerCom,\n            data: this.state.commentsOrder,\n            keyExtractor: function keyExtractor(unComentario) {\n              return unComentario.createdAt.toString();\n            },\n            renderItem: function renderItem(_ref) {\n              var item = _ref.item;\n              return _jsx(UnComentario, {\n                comment: item\n              });\n            }\n          })]\n        })\n      });\n    }\n  }]);\n  return Comments;\n}(Component);\nvar styles = StyleSheet.create({\n  containerCom: {\n    flex: 1\n  },\n  scroll: {\n    flex: 1\n  },\n  containerPost: {\n    alignItems: 'center',\n    height: '50vh',\n    marginTop: 30\n  },\n  profilePhoto: {\n    width: 60,\n    height: 60,\n    borderBottomRightRadius: 50,\n    borderBottomLeftRadius: 50,\n    borderTopRightRadius: 50,\n    borderTopLeftRadius: 50\n  },\n  username: {\n    fontSize: 20,\n    marginTop: 10,\n    fontWeight: 'bold'\n  },\n  postPhoto: {\n    marginTop: 10,\n    height: '70%',\n    width: '100%'\n  },\n  bio: {\n    alignSelf: 'flex-start',\n    fontSize: 20,\n    marginTop: 2,\n    marginLeft: 4\n  },\n  containerAdd: {\n    marginTop: '6%',\n    flexDirection: 'row',\n    backgroundColor: 'black',\n    height: 50,\n    alignItems: 'center'\n  },\n  input: {\n    padding: 5,\n    color: 'white',\n    width: '85%'\n  },\n  sendCont: {\n    backgroundColor: '#C3C3C3',\n    height: '100%',\n    width: '15%',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  send: {\n    width: '85%',\n    height: '85%'\n  }\n});\nexport default Comments;","map":{"version":3,"names":["React","Component","db","auth","firebase","UnComentario","Comments","props","state","comments","id","route","params","idPost","post","loading1","username","fotoUsuario","bioUsuario","collection","doc","onSnapshot","setState","data","commentsOrder","reverse","where","mail","docs","usuario","forEach","push","foto","bio","update","firestore","FieldValue","arrayUnion","owner","currentUser","email","createdAt","Date","now","then","styles","scroll","containerPost","profilePhoto","uri","postPhoto","photo","text","containerAdd","input","sendCont","sendComment","send","require","length","containerCom","unComentario","toString","item","StyleSheet","create","flex","alignItems","height","marginTop","width","borderBottomRightRadius","borderBottomLeftRadius","borderTopRightRadius","borderTopLeftRadius","fontSize","fontWeight","alignSelf","marginLeft","flexDirection","backgroundColor","padding","color","justifyContent"],"sources":["/Users/martucoletto/My Drive/ProgramaciÃ³n III - Vivone/repocursada/proyfinal-p3/src/screens/Comments.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { View, Text, Image, TextInput, TouchableOpacity} from 'react-native';\nimport { db, auth } from '../firebase/config';\nimport firebase from 'firebase';\nimport { StyleSheet,ActivityIndicator, FlatList } from 'react-native-web';\nimport UnComentario from '../Components/UnComentario'\n\nclass Comments extends Component{\n    constructor (props) {\n        super(props)\n        this.state={\n            comments: '',\n            id: this.props.route.params.idPost,\n            post: [],\n            loading1: true,\n            username:'',\n            fotoUsuario:'',\n            bioUsuario:''\n        }\n    }\n    \n    componentDidMount(){ \n    db.collection('posts').doc(this.state.id).onSnapshot(\n        doc => {\n                this.setState({\n                post: doc.data(),\n                loading1:false\n            }, () => this.setState({commentsOrder: this.state.post.comments.reverse()}))\n        })\n    db.collection('users').where('owner', '==', this.props.route.params.mail).onSnapshot(\n            docs =>{\n                let usuario = [];\n                docs.forEach (doc => {\n                    usuario.push({\n                        id: doc.id,\n                        data: doc.data()\n                    })\n                this.setState({\n                    username: usuario[0].data.username,\n                    fotoUsuario:usuario[0].data.foto,\n                    bioUsuario:usuario[0].data.bio\n                })\n                })\n            }\n        )\n}\n\nsendComment(comments) {\n    db.collection('posts')\n        .doc(this.state.id) \n        .update({\n            comments: firebase.firestore.FieldValue.arrayUnion({\n                owner: auth.currentUser.email,\n                comments: comments,\n                createdAt: Date.now()\n            })\n        })\n        .then(() => {\n            this.setState({\n                comments: ''\n            })\n        })\n}\n\nrender() {\n    return (\n        <View style={styles.scroll}>\n            {this.state.loading1 === true ? <ActivityIndicator size='large' color='green' /> :\n                <View style={styles.scroll}>\n                    <View style={styles.containerPost}>\n                        <Image style={styles.profilePhoto} source={{uri:this.state.fotoUsuario}} resizeMode='auto'/> \n                        <Text style={styles.username}>{this.state.username}</Text>\n                        <Image style={styles.postPhoto} source={{uri:this.state.post.photo}} resizeMode='contain' /> \n                    View\n                        <Text style={styles.bio}>{this.state.post.text}</Text>\n                    </View>\n                    <View style={styles.containerAdd}>\n                    <TextInput\n                        style={styles.input}\n                        placeholder='Agregar Comentario'\n                        keyboardType='default'\n                        onChangeText={text => this.setState({ comments: text })}\n                        value={this.state.comments}\n                    />\n                    <TouchableOpacity  style={styles.sendCont} onPress={() => this.sendComment(this.state.comments)}>\n                        <Image \n                            style={styles.send}\n                            source={require('../../assets/send.svg')}\n                            resizeMode='contain' \n                        />\n                    </TouchableOpacity>\n                    </View> \n                    {this.state.post.comments.length === 0 && this.state.loading1 === false ? \n                    <Text>no hay comentarios</Text> \n                    : \n                        <FlatList style = {styles.containerCom} data={this.state.commentsOrder} keyExtractor={unComentario=> unComentario.createdAt.toString()} renderItem={({ item }) =>  <UnComentario comment={item}/>} />\n                    }\n                </View>\n            }     \n            \n        </View>\n    )\n\n}\n}\n\nconst styles = StyleSheet.create({\n    containerCom:{\n        flex:1\n    },\n    scroll:{\n        flex:1\n    },\n    containerPost: {\n      alignItems:'center',\n      height:'50vh',\n      marginTop:30\n    },\n    profilePhoto:{\n        width:60,\n        height:60,\n        borderBottomRightRadius: 50,\n        borderBottomLeftRadius: 50,\n        borderTopRightRadius: 50,\n        borderTopLeftRadius: 50,\n    },\n    username:{\n        fontSize:20,\n        marginTop:10,\n        fontWeight: 'bold'\n\n    },\n    postPhoto:{\n       marginTop:10,\n       height:'70%',\n       width:'100%' \n    },\n    bio:{\n        alignSelf:'flex-start',\n        fontSize:20,\n        marginTop:2,\n        marginLeft:4\n    },\n    containerAdd:{\n        marginTop:'6%',\n        flexDirection:'row',\n        backgroundColor:'black',\n        height:50,\n        alignItems:'center'\n    },\n    input:{\n        padding:5,\n        color:'white',\n        width:'85%'\n    },\n    sendCont:{\n        backgroundColor:'#C3C3C3',\n        height:'100%',\n        width:'15%',\n        alignItems:'center',\n        justifyContent: 'center'\n    },\n    send:{\n        width:'85%',\n        height:'85%'\n    }\n\n  });\n  \n\nexport default Comments\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}